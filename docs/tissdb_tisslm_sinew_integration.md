# TissDB, TissLM, and Sinew Integration

This document outlines the integration between the three core components of the Quanta ecosystem: TissDB, TissLM, and Sinew.

## Overview

The Quanta ecosystem is designed as a cohesive whole, with each component playing a specialized role.

*   **TissDB:** A high-performance, C++ based NoSQL database that serves as the foundational data layer. It uses a Log-Structured Merge-Tree (LSM-Tree) for efficient writes and stores data in a flexible JSON-like document model. It is accessed via a RESTful API and queried using TissQL, a SQL-like language.

*   **TissLM:** A Python-based Large Language Model (LLM) built on a custom Transformer architecture. Its key feature is a Retrieval-Augmented Generation (RAG) pipeline. It leverages a `KnowledgeBase` component to retrieve contextual information, which it then uses to provide more accurate and relevant generated responses.

*   **Sinew:** A thread-safe, modern C++ client library for TissDB. It provides the essential "connective tissue" for any C++ application that needs to communicate with the TissDB server. It manages a connection pool, handles low-level networking, and exposes a clean API for executing queries and managing transactions.

## Integration Points

The components are designed to work together, primarily in a client-server and data-consumer relationship.

### TissLM and TissDB: The RAG Pipeline

The primary integration is between TissLM and TissDB. TissLM's intelligence is enhanced by its ability to retrieve real-time information from a knowledge source.

1.  **Knowledge Storage:** TissDB is the ideal persistent store for the knowledge that TissLM's `KnowledgeBase` component relies on. While the current Python implementation features an in-memory knowledge base, a production deployment would use a Python-based TissDB client to connect to a TissDB instance.
2.  **Data Flow:** The typical flow for a query is:
    *   A user prompt is sent to the TissLM.
    *   The TissLM's `KnowledgeBase` module formulates a TissQL query based on the prompt.
    *   The query is executed against a specific collection in TissDB.
    *   TissDB returns relevant documents (the "context").
    *   TissLM augments the original prompt with this context, using a template like: `context: {retrieved_documents} question: {original_prompt}`.
    *   The full prompt is processed by the Transformer model to generate a final, context-aware answer.

### Sinew and TissDB: The C++ Application Bridge

The integration between Sinew and TissDB is a direct, robust client-server connection.

*   **Purpose:** Any C++ application needing to read from or write to TissDB must use the Sinew library.
*   **Mechanism:** Sinew uses standard TCP sockets to connect to the TissDB REST API. It sends TissQL queries over the wire (using a simple length-prefix framing protocol) and deserializes the JSON responses.
*   **Functionality:** It abstracts away all the complexities of connection management, networking, and error handling, allowing developers to focus on their application logic.

## Configuration

Properly configuring the components to communicate with each other is crucial.

*   **TissDB Server:** Runs as a standalone process, listening for connections on a specific host and port (e.g., `localhost:8080`).

*   **Sinew Client (C++):** An application using Sinew must provide a `TissuConfig` object when creating the `TissuClient`.
    ```cpp
    #include "tissu_sinew.h"

    tissudb::TissuConfig config;
    config.host = "127.0.0.1";
    config.port = 8080;
    config.pool_size = 10; // Max 10 concurrent connections

    auto client = tissudb::TissuClient::create(config);
    ```

*   **TissLM (Python):** The `KnowledgeBase` component would need to be configured with the TissDB server's connection details. While the exact client is not in this part of the codebase, the configuration would look conceptually like this:
    ```python
    # Hypothetical TissLM configuration
    knowledge_base_config = {
        "provider": "tissdb",
        "host": "127.0.0.1",
        "port": 8080,
        "collection": "knowledge_articles"
    }
    ```

## Troubleshooting

*   **Sinew: Connection Errors (`TissuConnectionException`)**
    *   Verify that the TissDB server process is running.
    *   Check that the host and port in `TissuConfig` are correct and that there are no firewalls blocking the connection.
    *   If you see pool timeout errors, consider increasing `pool_size` in the config.

*   **TissLM: Irrelevant or Missing Context**
    *   Ensure the `KnowledgeBase` is correctly configured to connect to TissDB.
    *   Verify that the target TissDB collection exists and contains relevant, indexed data.
    *   Check the TissQL queries being generated by the `KnowledgeBase` to ensure they are well-formed.

*   **TissDB: Query Errors (`TissuQueryException`)**
    *   Check the syntax of the TissQL query being sent.
    *   Ensure the targeted collection and documents exist.
    *   If using parameterized queries, ensure all parameters are correctly named and have valid values.
